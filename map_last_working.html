<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hex Grid Map with Slide-out Menu</title>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@latest"></script>
  <!-- At the bottom of your HTML file, before the closing body tag -->
  <!-- <script src="dropdown.js"></script> -->

  <style>
    /* Styling for the dropdown button */
    .dropbtn {
      background-color: #262d3d;
      /* Dark background color */
      color: #fff;
      /* White text color */
      padding: 10px;
      font-size: 16px;
      border: 2px solid transparent;
      border-top: 2px solid #87CEFA2b;
      /* Light blue border on top */
      border-bottom: 2px solid transparent;
      border-radius: 8px;
      /* Rounded corners */
      width: 100%;
      text-align: left;
      display: flex;
      justify-content: space-between;
      align-items: center;
      outline: none;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.3);
      /* Shadow effect */
      cursor: pointer;
    }

    .dropbtn:after {
      content: 'â–¼';
      /* Downward arrow */
      font-size: 12px;
      margin-left: 10px;
      color: #fff;
      /* White arrow */
    }

    /* Remove the top border highlight when dropdown is open */
    .dropdown.open .dropbtn {
      /* border-top: none; */
    }

    /* Styling for the dropdown container */
    .dropdown {
      position: relative;
      display: inline-block;
      width: 220px;
    }

    /* Styling for the dropdown content */
    .dropdown-content {
      display: none;
      /* Initially hidden */
      position: absolute;
      background-color: #1f1f1f;
      /* Same dark background */
      color: #fff;
      min-width: 100%;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.3);
      /* Same shadow effect */
      border-radius: 8px;
      z-index: 1;
      /* border-top: 2px solid #87CEFA; */
      /* Highlight border at the top */
    }

    /* Ensure dropdown content displays when the 'open' class is added */
    .dropdown.open .dropdown-content {
      display: block;

    }

    */

    /* Styling for the dropdown item */
    .dropdown-item {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding-top: 10px;
      padding-bottom: 10px;
      padding-left: 20px;
      padding-right: 10px;
      cursor: pointer;
      transition: background-color 0.3s;
      border-bottom: 1px solid #3a3a3a;
      /* Slight bottom border for each item */
    }

    .dropdown-item span {
      margin-left: 0px;
      /* Ensure no margin on the span */
      padding: 0px;
      /* Remove any default padding */
    }


    .dropdown-item:hover {
      background-color: #87CEFA;
      /* Light blue background on hover */
      color: #000;
      /* Change text color on hover */
    }

    /* Highlight the selected item */
    .selected-item {
      background-color: #87CEFA;
      /* Light blue background to highlight */
      color: #000;
      /* Change text color for selected item */
      font-weight: bold;
      /* Make the text bold */
    }

    /* Hide the Edit and Delete buttons by default */
    .dropdown-item button {
      display: none;
    }

    /* Show the Edit and Delete buttons only when hovering over the dropdown item */
    .dropdown-item:hover button {
      display: inline-block;
    }

    /* Div for holding Create and Join buttons */
    .dropdown-footer {
      display: flex;
      justify-content: space-around;
      /* Evenly space the buttons */
      padding: 10px;
      border-top: 1px solid #3a3a3a;
    }

    .dropdown-footer button {
      background-color: #87CEFA;
      color: #000;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 14px;
      border-radius: 5px;
      transition: background-color 0.3s;
      width: 80px;
      /* Ensure consistent width */
    }

    .dropdown-footer button:hover {
      background-color: #5db3e3;
    }

    /* Styling for displaying selected information */
    #selectedInfo {
      margin-top: 20px;
      padding: 10px;
      background-color: #f4f4f4;
      border: 1px solid #ddd;
      width: fit-content;
    }

    .group_avatar {
      position: relative;
      background-color: #ff0000;
      /* Set a background color for visibility */
      height: 30px;
      /* Set a height for the avatar */
      width: 30px;
      /* Set a width for the avatar */
      border-radius: 50%;
      /* Make it circular */
      margin-right: 10px;
      /* Add some space between the avatar and the text */
      display: inline-block;
      /* Ensure it stays inline with the text */
      top: 0;
      /* Align it vertically with the text */
    }
  </style>
</head>

<body>
  <!-- Loading Spinner -->
  <div id="loadingSpinner"></div>

  <div id="map"></div>

  <!-- Slide-out Menu -->
  <div id="menu" class="menu">
    <!-- Top menu containing dropdown, buttons, and close button -->
    <div class="top-menu">
      <div class="close-container">
        <button class="close-menu" id="close-menu">&times;</button>
      </div>
      <h3>Group Selection</h3>
      <!-- <select>
        <option value="option1">Option 1</option>
        <option value="option2">Option 2</option>
        <option value="option3">Option 3</option>
      </select> -->

      <!-- Dropdown with dynamic items -->
      <div class="dropdown" id="customDropdown">
        <button class="dropbtn" id="dropdownButton" onclick="toggleDropdown()">John Doe</button>
        <div class="dropdown-content" id="dropdownItems">
          <!-- Dropdown Items -->
          <div class="dropdown-item" data-value="550e8400-e29b-41d4-a716-446655440000" onclick="selectItem(this)">
            <div class="group_avatar"></div>
            <span>John Doe</span>
            <button onclick="editItem('John Doe')">Edit</button>
            <button onclick="deleteItem('John Doe')">Delete</button>
          </div>
          <div class="dropdown-item" data-value="550e8400-e29b-41d4-a716-446655440001" onclick="selectItem(this)">
            <span>Jane Smith</span>
            <button onclick="editItem('Jane Smith')">Edit</button>
            <button onclick="deleteItem('Jane Smith')">Delete</button>
          </div>

          <!-- Footer with Create and Join Buttons -->
          <div class="dropdown-footer">
            <button onclick="createItem()">Create</button>
            <button onclick="joinItem()">Join</button>
          </div>
        </div>
      </div>
      <div class="top-menu-buttons">
        <button id="members-btn">
          <span class="svg-icon">
            <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_2_187)">
                <path
                  d="M7.5625 13.75C10.0305 13.75 12.0312 11.7493 12.0312 9.28125C12.0312 6.81323 10.0305 4.8125 7.5625 4.8125C5.09448 4.8125 3.09375 6.81323 3.09375 9.28125C3.09375 11.7493 5.09448 13.75 7.5625 13.75Z"
                  stroke="#080D2B" stroke-width="1.5" stroke-miterlimit="10" />
                <path
                  d="M13.3559 4.97901C13.9705 4.80583 14.6151 4.76638 15.2463 4.86331C15.8775 4.96024 16.4805 5.19131 17.0149 5.54094C17.5492 5.89057 18.0025 6.35065 18.344 6.89019C18.6856 7.42973 18.9076 8.0362 18.995 8.66876C19.0825 9.30131 19.0334 9.94527 18.851 10.5572C18.6686 11.1692 18.3572 11.735 17.9377 12.2165C17.5183 12.698 17.0005 13.084 16.4193 13.3485C15.8381 13.6131 15.207 13.75 14.5684 13.75C15.782 13.7492 16.978 14.0407 18.0551 14.6001C19.1321 15.1594 20.0586 15.9701 20.7559 16.9634M1.37476 16.9638C2.07268 15.9711 2.99923 15.1608 4.07616 14.6015C5.15309 14.0421 6.3488 13.7501 7.56233 13.75C8.77586 13.75 9.97159 14.0419 11.0486 14.6012C12.1255 15.1605 13.0521 15.9707 13.7501 16.9634"
                  stroke="#080D2B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </g>
              <defs>
                <clipPath id="clip0_2_187">
                  <rect width="22" height="22" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </span>
          <span>Members</span>
        </button>
        <button id="places-btn">
          <span class="svg-icon">
            <svg width="23" height="22" viewBox="0 0 23 22" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M12.586 16.2858L12.5858 16.2861C12.4681 16.4669 12.3072 16.6154 12.1175 16.7182C11.9279 16.821 11.7156 16.8749 11.4999 16.8749C11.2842 16.8749 11.0719 16.821 10.8823 16.7182C10.6927 16.6155 10.5318 16.467 10.4141 16.2863C10.4141 16.2863 10.4141 16.2862 10.414 16.2861L12.586 16.2858ZM12.586 16.2858C12.9343 15.7478 13.361 15.02 13.8 14.2104C15.7201 14.3339 17.1282 14.5912 18.0559 14.8739C18.5283 15.0179 18.8698 15.1667 19.09 15.3038C19.2002 15.3725 19.2744 15.4348 19.3193 15.4875C19.3642 15.5399 19.3705 15.5713 19.3707 15.5826C19.3697 15.5905 19.3591 15.6388 19.2744 15.7198C19.1708 15.8189 18.9637 15.9592 18.5572 16.1208H18.5491H18.5205M12.586 16.2858L18.5205 16.1208M18.5205 16.1208L18.4939 16.1313M18.5205 16.1208L18.4939 16.1313M18.4939 16.1313C17.0772 16.6912 14.3986 17.0374 11.4999 17.0374C8.6016 17.0374 5.92207 16.6913 4.50454 16.1468L4.47857 16.1368M18.4939 16.1313L4.47857 16.1368M4.47857 16.1368H4.45075M4.47857 16.1368H4.45075M4.45075 16.1368H4.44811C4.03971 15.9688 3.83125 15.8248 3.72678 15.7234C3.64052 15.6397 3.6301 15.5904 3.62909 15.5826C3.62933 15.5713 3.63566 15.54 3.68051 15.4875M4.45075 16.1368L3.68051 15.4875M3.68051 15.4875C3.72546 15.4348 3.79959 15.3725 3.90985 15.3038M3.68051 15.4875L3.90985 15.3038M3.90985 15.3038C4.12999 15.1667 4.47158 15.0179 4.94394 14.8739M3.90985 15.3038L4.94394 14.8739ZM4.94394 14.8739C5.87168 14.5912 7.27991 14.3339 9.20026 14.2104L4.94394 14.8739ZM18.1239 14.0921C17.0335 13.7809 15.6101 13.5805 14.1906 13.4744C14.7446 12.4042 15.2936 11.2408 15.7126 10.1784C16.1556 9.05525 16.4624 8.02359 16.4624 7.33325C16.4624 6.01711 15.9396 4.75488 15.0089 3.82423C14.0783 2.89358 12.8161 2.37075 11.4999 2.37075C10.1838 2.37075 8.92155 2.89358 7.9909 3.82423C7.06025 4.75488 6.53742 6.01711 6.53742 7.33325C6.53742 8.02359 6.84422 9.05525 7.28723 10.1784C7.70627 11.2408 8.2552 12.4042 8.80923 13.4744C7.38976 13.5805 5.96636 13.7809 4.87595 14.0921C4.30257 14.2557 3.81109 14.4527 3.45975 14.6893C3.11082 14.9243 2.87075 15.2196 2.87075 15.5833C2.87075 15.9488 3.11436 16.2473 3.51283 16.4999C3.11436 16.7525 2.87075 17.0511 2.87075 17.4166C2.87075 17.8425 3.20487 18.1792 3.68053 18.4416C4.16481 18.7087 4.84595 18.9279 5.64808 19.1023C7.25495 19.4516 9.38619 19.6291 11.4999 19.6291C13.6136 19.6291 15.7449 19.4516 17.3518 19.1023C18.1539 18.9279 18.835 18.7087 19.3193 18.4416C19.795 18.1792 20.1291 17.8425 20.1291 17.4166C20.1291 17.0511 19.8855 16.7525 19.487 16.4999C19.8855 16.2473 20.1291 15.9488 20.1291 15.5833C20.1291 15.2196 19.889 14.9243 19.5401 14.6893C19.1887 14.4527 18.6973 14.2557 18.1239 14.0921ZM9.66658 10.6208H8.28934C8.00577 9.96162 7.76111 9.32886 7.58533 8.76982C7.40107 8.18384 7.29635 7.69062 7.29575 7.33631C7.34043 6.27252 7.78707 5.26525 8.54558 4.51793C9.30482 3.76988 10.3198 3.33812 11.3853 3.31001C12.4508 3.2819 13.4872 3.65952 14.2848 4.3665C15.0412 5.03689 15.5293 5.95597 15.6631 6.95408H14.2499C14.1494 6.95408 14.0529 6.99403 13.9818 7.06514C13.9107 7.13625 13.8708 7.23269 13.8708 7.33325C13.8708 7.43381 13.9107 7.53026 13.9818 7.60136C14.0529 7.67247 14.1494 7.71242 14.2499 7.71242H15.667C15.6032 8.16024 15.4395 8.73284 15.206 9.3776C14.944 10.1013 14.5978 10.9064 14.2177 11.7119C13.4577 13.3223 12.5664 14.9257 11.951 15.8725C11.9003 15.9436 11.8334 16.0017 11.7558 16.0419C11.6775 16.0825 11.5905 16.1037 11.5022 16.1037C11.4139 16.1037 11.327 16.0825 11.2486 16.0419C11.1714 16.0019 11.1048 15.9442 11.0542 15.8736C10.1526 14.4274 9.3424 12.9263 8.6284 11.3791H9.66658C9.76715 11.3791 9.86359 11.3391 9.9347 11.268C10.0058 11.1969 10.0458 11.1005 10.0458 10.9999C10.0458 10.8994 10.0058 10.8029 9.9347 10.7318C9.86359 10.6607 9.76715 10.6208 9.66658 10.6208ZM3.629 15.5815C3.62902 15.5815 3.62906 15.5818 3.62908 15.5824L3.629 15.5815ZM11.4999 18.8707C9.02302 18.8707 7.02945 18.6377 5.65905 18.3234C4.97284 18.166 4.44907 17.9896 4.10041 17.8154C3.92559 17.728 3.80179 17.6445 3.72387 17.5696C3.64509 17.4937 3.6295 17.4429 3.62909 17.4176C3.63008 17.4106 3.64011 17.3638 3.72181 17.2843C3.81837 17.1902 4.00813 17.0578 4.374 16.9038C5.93738 17.4667 8.58172 17.7957 11.4999 17.7957C14.4181 17.7957 17.0624 17.4667 18.6237 16.9038C18.9907 17.0579 19.181 17.1903 19.2779 17.2844C19.3596 17.3638 19.3697 17.4105 19.3707 17.4176C19.3703 17.4429 19.3547 17.4937 19.276 17.5696C19.198 17.6445 19.0742 17.728 18.8994 17.8154C18.5508 17.9896 18.027 18.166 17.3408 18.3234C15.9704 18.6377 13.9768 18.8707 11.4999 18.8707Z"
                fill="#080D2B" stroke="#080D2B" stroke-width="0.3" />
            </svg>
          </span>
          <span>Places</span>
        </button>
      </div>
    </div>
    <div class="members-container" id="membersCon">
      <!-- Members div with dynamic height and scrolling -->
      <div class="members-div" id="membersDiv">
        <!-- Member list will be dynamically added here -->
        <div class="member-box">
          <div class="member-avatar"><img
              src="https://raw.githubusercontent.com/they-call-me-E/Sharptools/main/CustomeTile/Mapviewer/pngimg.com%20-%20deadpool_PNG15.png">
          </div>
          <div>
            <div class="member-name">Jake Mohl</div>
            <div class="gps-coordinates">Lat: 34.227085, Long: -80.843124</div>
          </div>
        </div>
        <div class="member-box">
          <div class="member-avatar"><img
              src="https://raw.githubusercontent.com/they-call-me-E/Sharptools/main/CustomeTile/Mapviewer/pngimg.com%20-%20deadpool_PNG15.png">
          </div>
          <div>
            <div class="member-name">Jake Mohl</div>
            <div class="gps-coordinates">Lat: 32.227085, Long: -80.843124</div>
          </div>
        </div>
      </div>
      <button id="members-settings-btn">
        <span class="svg-icon">
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"
            style="padding-right: 5px">
            <g clip-path="url(#clip0_2_187)">
              <path
                d="M7.5625 13.75C10.0305 13.75 12.0312 11.7493 12.0312 9.28125C12.0312 6.81323 10.0305 4.8125 7.5625 4.8125C5.09448 4.8125 3.09375 6.81323 3.09375 9.28125C3.09375 11.7493 5.09448 13.75 7.5625 13.75Z"
                stroke="#080D2B" stroke-width="1.5" stroke-miterlimit="10" />
              <path
                d="M13.3559 4.97901C13.9705 4.80583 14.6151 4.76638 15.2463 4.86331C15.8775 4.96024 16.4805 5.19131 17.0149 5.54094C17.5492 5.89057 18.0025 6.35065 18.344 6.89019C18.6856 7.42973 18.9076 8.0362 18.995 8.66876C19.0825 9.30131 19.0334 9.94527 18.851 10.5572C18.6686 11.1692 18.3572 11.735 17.9377 12.2165C17.5183 12.698 17.0005 13.084 16.4193 13.3485C15.8381 13.6131 15.207 13.75 14.5684 13.75C15.782 13.7492 16.978 14.0407 18.0551 14.6001C19.1321 15.1594 20.0586 15.9701 20.7559 16.9634M1.37476 16.9638C2.07268 15.9711 2.99923 15.1608 4.07616 14.6015C5.15309 14.0421 6.3488 13.7501 7.56233 13.75C8.77586 13.75 9.97159 14.0419 11.0486 14.6012C12.1255 15.1605 13.0521 15.9707 13.7501 16.9634"
                stroke="#080D2B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </g>
            <defs>
              <clipPath id="clip0_2_187">
                <rect width="22" height="22" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </span>
        <span>Members Settings</span>
      </button>
    </div>
    <button class="setting-button">
      <svg width="31" height="31" viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M15.5 21.3125C18.7101 21.3125 21.3125 18.7101 21.3125 15.5C21.3125 12.2898 18.7101 9.6875 15.5 9.6875C12.2898 9.6875 9.6875 12.2898 9.6875 15.5C9.6875 18.7101 12.2898 21.3125 15.5 21.3125Z"
          stroke="#080D2B" stroke-width="2.6" stroke-linecap="round" stroke-linejoin="round" />
        <path
          d="M14.879 5.34679L12.594 3.63357C12.4714 3.54135 12.3287 3.47958 12.1775 3.45335C12.0263 3.42713 11.8711 3.4372 11.7246 3.48274C11.0169 3.70434 10.3304 3.98841 9.67299 4.33158C9.5369 4.40296 9.41975 4.50568 9.33119 4.63126C9.24262 4.75684 9.1852 4.90169 9.16365 5.05383L8.75971 7.88147C8.60574 8.01795 8.45501 8.15991 8.3075 8.30733C8.16004 8.45479 8.01805 8.60557 7.88153 8.75967L5.05433 9.164C4.90243 9.18548 4.75781 9.24275 4.63238 9.33109C4.50695 9.41943 4.40431 9.53631 4.33292 9.6721C3.98922 10.3292 3.7046 11.0156 3.48242 11.723C3.43667 11.8697 3.42646 12.0252 3.45264 12.1766C3.47882 12.3281 3.54063 12.4711 3.63297 12.5939L5.34679 14.879C5.33442 15.0844 5.32821 15.2913 5.32815 15.4999C5.32815 15.7084 5.33437 15.9154 5.3468 16.1209L3.63357 18.406C3.54135 18.5286 3.47958 18.6713 3.45335 18.8225C3.42713 18.9736 3.4372 19.1289 3.48274 19.2754C3.70434 19.983 3.98841 20.6696 4.33158 21.327C4.40296 21.4631 4.50568 21.5802 4.63126 21.6688C4.75684 21.7574 4.90169 21.8148 5.05383 21.8363L7.88147 22.2403C8.01795 22.3942 8.1599 22.545 8.30733 22.6925C8.45479 22.8399 8.60556 22.9819 8.75966 23.1184L9.164 25.9456C9.18548 26.0975 9.24274 26.2422 9.33108 26.3676C9.41942 26.493 9.5363 26.5957 9.6721 26.6671C10.3292 27.0108 11.0155 27.2954 11.723 27.5176C11.8697 27.5633 12.0252 27.5735 12.1766 27.5473C12.3281 27.5212 12.4711 27.4593 12.5939 27.367L14.879 25.6532C15.0844 25.6656 15.2913 25.6718 15.4999 25.6718C15.7084 25.6718 15.9154 25.6656 16.1209 25.6532L18.406 27.3664C18.5286 27.4586 18.6713 27.5204 18.8225 27.5466C18.9736 27.5728 19.1289 27.5628 19.2754 27.5172C19.983 27.2956 20.6696 27.0116 21.327 26.6684C21.4631 26.597 21.5802 26.4943 21.6688 26.3687C21.7574 26.2431 21.8148 26.0983 21.8363 25.9461L22.2403 23.1185C22.3942 22.982 22.545 22.8401 22.6927 22.6927C22.8399 22.5452 22.9819 22.3944 23.1184 22.2403L25.9456 21.836C26.0975 21.8145 26.2422 21.7572 26.3676 21.6689C26.493 21.5806 26.5957 21.4637 26.6671 21.3279C27.0108 20.6708 27.2954 19.9844 27.5176 19.2769C27.5633 19.1302 27.5735 18.9748 27.5473 18.8233C27.5212 18.6719 27.4593 18.5289 27.367 18.4061L25.6532 16.121C25.6656 15.9156 25.6718 15.7087 25.6718 15.5001C25.6718 15.2916 25.6656 15.0846 25.6532 14.8791L27.3664 12.594C27.4586 12.4714 27.5204 12.3287 27.5466 12.1775C27.5728 12.0263 27.5628 11.8711 27.5172 11.7246C27.2956 11.0169 27.0116 10.3304 26.6684 9.67299C26.597 9.5369 26.4943 9.41975 26.3687 9.33119C26.2431 9.24262 26.0983 9.1852 25.9461 9.16365L23.1185 8.75971C22.982 8.60574 22.8401 8.45501 22.6927 8.3075C22.5452 8.16004 22.3944 8.01805 22.2403 7.88153L21.836 5.05433C21.8145 4.90243 21.7572 4.75781 21.6689 4.63238C21.5806 4.50695 21.4637 4.40431 21.3279 4.33292C20.6708 3.98922 19.9844 3.7046 19.2769 3.48242C19.1302 3.43667 18.9748 3.42646 18.8233 3.45264C18.6719 3.47882 18.5289 3.54063 18.4061 3.63297L16.121 5.34679C15.9156 5.33442 15.7087 5.32821 15.5001 5.32815C15.2916 5.32815 15.0845 5.33436 14.879 5.34679Z"
          stroke="#080D2B" stroke-width="2.6" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </button>
    <button class="profile-button" id="profile-button">
      <img
        src="https://raw.githubusercontent.com/they-call-me-E/Sharptools/main/CustomeTile/Mapviewer/pngimg.com%20-%20deadpool_PNG15.png"
        alt="Profile Image">
    </button>
    <div class="profile-menu">
      <div class="back-arrow" id="back-arrow">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </div>

      <!-- Profile Section -->
      <div class="profile-section">
        <img
          src="https://raw.githubusercontent.com/they-call-me-E/Sharptools/main/CustomeTile/Mapviewer/pngimg.com%20-%20deadpool_PNG15.png"
          alt="Profile Picture" class="profile-img" />
        <div class="profile-name" id="profileName">Jon MÃ¶ller</div>
        <p class="profile-location"><span>&#x1F4CD;</span> Stockholm, Sweden</p>

        <!-- <button class="upgrade-btn">Upgrade Now - Go Pro</button> -->
      </div>

      <!-- Settings Section -->
      <div class="settings-section">
        <h4>Settings</h4>
        <ul class="settings-list">
          <li>
            <span class="settings-icon">&#x1F319;</span> Dark Mode
            <label class="switch">
              <input type="checkbox" id="dark-mode-toggle" checked>
              <span class="slider round"></span>
            </label>
          </li>
          <li>
            <span class="settings-icon">&#x1F514;</span> Notifications
            <span class="toggle-btn">On</span>
          </li>
          <!-- <li><span class="settings-icon">&#x1F512;</span> Privacy</li>
          <li><span class="settings-icon">&#x1F6E1;</span> Security</li> -->
          <li><span class="settings-icon"><svg class="svg-icon"
                style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;"
                viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M723.4304 508.60032c-54.12352 47.74912-125.9776 77.056-205.16352 77.056-80.36352 0-153.40032-30.2592-207.76448-79.42144-126.45376 33.09056-204.69248 146.0736-204.69248 281.04192v68.78208c0 160.96768 812.3904 160.96768 812.3904 0v-68.78208c-0.00512-131.41504-74.21952-242.5088-194.76992-278.67648z m-205.16352 28.12928c140.16512 0 254.09536-109.44 254.09536-244.63872S658.66752 47.21664 518.26688 47.21664c-139.9296 0-253.85472 109.67552-253.85472 244.87424 0 135.20384 113.92512 244.63872 253.85472 244.63872z m0 0"
                  fill="currentColor" />
              </svg></span> Account</li>
          <!-- <li><span class="settings-icon">&#x2753;</span> Help</li> -->
          <li>
            <span class="settings-icon">
              <svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                <!-- <g fill="#141414" fill-rule="nonzero"> -->
                <path
                  d="m20 12c0 .5522847-.4477153 1-1 1s-1-.4477153-1-1c0-4.418278-3.581722-8-8-8s-8 3.581722-8 8 3.581722 8 8 8c.5522847 0 1 .4477153 1 1s-.4477153 1-1 1c-5.5228475 0-10-4.4771525-10-10s4.4771525-10 10-10 10 4.4771525 10 10z"
                  transform="matrix(.70710678 -.70710678 .70710678 .70710678 -5.556349 10.585786)" />
                <path
                  d="m10 13c-.55228475 0-1-.4477153-1-1s.44771525-1 1-1h13c.5522847 0 1 .4477153 1 1s-.4477153 1-1 1z" />
                <path
                  d="m19.2928932 9.70710678c-.3905243-.39052429-.3905243-1.02368927 0-1.41421356s1.0236893-.39052429 1.4142136 0l3 2.99999998c.3905243.3905243.3905243 1.0236893 0 1.4142136l-3 3c-.3905243.3905243-1.0236893.3905243-1.4142136 0s-.3905243-1.0236893 0-1.4142136l2.2928932-2.2928932z" />
                <!-- </g> -->
              </svg>
            </span>
            Logout
          </li>
        </ul>
      </div>
    </div>

  </div>

  <button id="toggle-menu">â˜°</button>
  <script src="script.js"></script>
  <!-- <script>
    mapboxgl.accessToken =
      "pk.eyJ1IjoidGhleWNhbGxtZWUiLCJhIjoiY2xhZXF6anQxMHgzazNxczNzd2I5em10dyJ9.fa-pBQ_2cMg9H2fD-FBCDg";
    const map = new mapboxgl.Map({
      container: "map",
      style: "mapbox://styles/mapbox/dark-v10",
      center: [-82.04842360357094, 35.18969231143789],
      zoom: 8,
    });

    map.on("load", () => {
      console.log("Map loaded");
      showLoadingSpinner();
      fetchData()
        .then(() => fetchmembersData())
        .finally(() => hideLoadingSpinner());
    });

    // Show loading spinner
    function showLoadingSpinner() {
      document.getElementById("loadingSpinner").style.display = "block";
    }

    // Hide loading spinner
    function hideLoadingSpinner() {
      document.getElementById("loadingSpinner").style.display = "none";
    }

    // Fetch geofence data and add it to the map
    async function fetchData() {
      console.log("Fetching geofence data...");
      try {
        const response = await fetch(
          "https://group-api-b4pm.onrender.com/api/groups/66d1e4da82271c65db81722d/fences",
          {
            headers: {
              Authorization:
                "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY2Yzc3N2RkN2YyYTAyMjQxODllM2MwMyIsIm5hbWUiOiJSb255IEtoYW4iLCJlbWFpbCI6InNoYWtpYkBnbWFpbC5jb20iLCJpYXQiOjE3MjUwMzE1NjgsImV4cCI6MTczMjgwNzU2OH0.Kk9HijZxMnJJXjV6jBRxYwwEG_gR3JKtxH0VDQcS6PQ",
            },
          }
        );
        const data = await response.json();
        console.log("Fence data fetched:", data);

        if (data && data.document) {
          data.document.forEach((geofence) => {
            addGeofence(geofence);
          });
        } else {
          console.error("Geofence data structure is incorrect:", data);
        }
      } catch (error) {
        console.error("Error fetching geofence data:", error);
      }
    }

    // Add geofence to the map
    function addGeofence(geofence) {
      const center = [geofence.longitude, geofence.latitude];
      const radiusInMeters = parseFloat(geofence.radius);
      const options = { steps: 64, units: "meters" };
      const circle = turf.circle(center, radiusInMeters, options);

      // Add a filled circle for the geofence
      map.addLayer({
        id: geofence.uuid,
        type: "fill",
        source: {
          type: "geojson",
          data: circle,
        },
        paint: {
          "fill-color": "#007cbf",
          "fill-opacity": 0.25,
        },
      });

      // Add a marker at the center of the geofence
      const defaultMarker = new mapboxgl.Marker({
        anchor: "bottom",
        offset: [0, 24],
      });
      defaultMarker.setLngLat(center).addTo(map);

      // Add an outer circle to represent the radius visually
      map.addLayer({
        id: geofence.uuid + "-circle",
        type: "circle",
        source: {
          type: "geojson",
          data: {
            type: "Feature",
            geometry: { type: "Point", coordinates: center },
          },
        },
        paint: {
          "circle-radius": 22,
          "circle-color": "#FFFFFF",
          "circle-opacity": 1,
        },
      });
    }

    // Fetch member data and add it to the map and slide-out menu
    async function fetchmembersData() {
      console.log("Fetching members data...");
      try {
        const response = await fetch(
          "https://group-api-b4pm.onrender.com/api/groups/66d1e4da82271c65db81722d/members",
          {
            headers: {
              Authorization:
                "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY2Yzc3N2RkN2YyYTAyMjQxODllM2MwMyIsIm5hbWUiOiJSb255IEtoYW4iLCJlbWFpbCI6InNoYWtpYkBnbWFpbC5jb20iLCJpYXQiOjE3MjUwMzE1NjgsImV4cCI6MTczMjgwNzU2OH0.Kk9HijZxMnJJXjV6jBRxYwwEG_gR3JKtxH0VDQcS6PQ",
            },
          }
        );

        if (!response.ok) {
          // Log more details if the response is not OK
          throw new Error(
            `HTTP error! status: ${response.status}, message: ${response.statusText}`
          );
        }

        const data = await response.json();
        if (data && data.document && Array.isArray(data.document.members)) {
          data.document.members.forEach((member) => {
            const bgColor = getRandomColor();
            addMemberToMenu(member, bgColor); // Add member to the slide-out menu
            addMemberMarker(member, bgColor); // Add member to the map
          });
        } else {
          console.error("Unexpected data structure:", data);
        }
      } catch (error) {
        console.error("Error fetching members data:", error);
      }
    }

    // Add member to the slide-out menu
    function addMemberToMenu(memberData, bgColor) {
      const membersDiv = document.getElementById("membersDiv");

      // Create a member box
      const memberBox = document.createElement("div");
      memberBox.className = "member-box";

      // Create the avatar/initials circle
      const avatarDiv = document.createElement("div");
      avatarDiv.className = "member-avatar";

      if (memberData.avatar) {
        const img = document.createElement("img");
        img.src = memberData.avatar;
        avatarDiv.appendChild(img);
      } else {
        const initialsDiv = document.createElement("div");
        initialsDiv.textContent = getInitials(memberData.name);
        initialsDiv.style.backgroundColor = bgColor;
        initialsDiv.style.height = "90%";
        initialsDiv.style.width = "90%";
        initialsDiv.style.borderRadius = "9999px";
        avatarDiv.appendChild(initialsDiv);
      }

      // Add the avatar/initials to the member box
      memberBox.appendChild(avatarDiv);

      // Add member name and coordinates
      const infoDiv = document.createElement("div");
      infoDiv.innerHTML = `
                <div class="member-name">${memberData.name}</div>
                <div class="gps-coordinates">Lat: ${memberData.location.latitude}, Long: ${memberData.location.longitude}</div>
            `;
      memberBox.appendChild(infoDiv);

      // Append the member box to the members div
      membersDiv.appendChild(memberBox);

      // Add click event to fly to the member's marker location
      memberBox.addEventListener("click", function () {
        const lat = memberData.location.latitude;
        const lng = memberData.location.longitude;
        map.flyTo({
          center: [lng, lat],
          zoom: 12,
          essential: true,
        });
      });
    }

    // Add member marker to the map with expandable rectangle on click
    function addMemberMarker(memberData, bgColor) {
      const { latitude, longitude } = memberData.location;
      if (!latitude || !longitude) {
        console.error("Missing latitude or longitude for member:", memberData);
        return;
      }

      // Create the main marker div
      const el = document.createElement("div");
      el.className = "marker";

      // Create the circular marker div
      const circleDiv = document.createElement("div");
      circleDiv.classList.add("circle-div");

      // If the member has an avatar, show it in the circle
      if (memberData.avatar) {
        const avatarImg = document.createElement("img");
        avatarImg.src = memberData.avatar;
        circleDiv.appendChild(avatarImg); // Add avatar image inside the circle
      } else {
        const innerCircle = document.createElement("div");
        innerCircle.classList.add("circle-inner");
        innerCircle.style.backgroundColor = bgColor; // Set background color dynamically

        const initialsDiv = document.createElement("div");
        initialsDiv.textContent = getInitials(memberData.name); // Add initials

        innerCircle.appendChild(initialsDiv);
        circleDiv.appendChild(innerCircle);
      }

      el.appendChild(circleDiv); // Append circle to main marker

      // Add tail div for the marker
      const tailDiv = document.createElement("div");
      tailDiv.classList.add("tail-div");
      el.appendChild(tailDiv);

      // Create the rectangle for expanded view
      const expandedDiv = document.createElement("div");
      expandedDiv.classList.add("marker-expanded");

      // Add the circle marker inside the expanded rectangle
      const expandedCircleDiv = circleDiv.cloneNode(true);
      expandedDiv.appendChild(expandedCircleDiv);

      // Add content to the expanded marker
      const content = `
      <div class="content">
        <strong>${memberData.name}</strong><br>
        Lat: ${latitude}<br>
        Long: ${longitude}<br>
        Battery: ${memberData.battery || 'N/A'}%
      </div>
      <button class="close-btn">&times;</button>
  `;
      expandedDiv.innerHTML += content;
      expandedDiv.querySelector('.close-btn').style.display = "block"; // Show the close button

      el.appendChild(expandedDiv); // Append the expanded div to the marker

      // Add the marker to the map
      const marker = new mapboxgl.Marker(el).setLngLat([longitude, latitude]).addTo(map);

      // Marker click event to expand into a rectangle and fly to the location
      el.addEventListener("click", function () {
        // Fly to the marker location
        map.flyTo({
          center: [longitude, latitude],
          zoom: 12,
          essential: true,
        });

        // Toggle marker expansion
        if (expandedDiv.style.display === "none") {
          expandedDiv.style.display = "block"; // Show expanded div
          circleDiv.style.display = "none"; // Hide circular marker
        } else {
          expandedDiv.style.display = "none"; // Hide expanded div
          circleDiv.style.display = "flex"; // Restore circular marker
        }
      });

      // Close button event to collapse the expanded marker
      expandedDiv.querySelector(".close-btn").addEventListener("click", (e) => {
        e.stopPropagation(); // Prevent click event from bubbling to the map
        expandedDiv.style.display = "none"; // Hide expanded div
        circleDiv.style.display = "flex"; // Show circular marker again
      });
    }

    // Toggle the menu open
    document
      .getElementById("toggle-menu")
      .addEventListener("click", function () {
        document.body.classList.add("menu-open");
      });

    // Close the menu with the close button
    document
      .getElementById("close-menu")
      .addEventListener("click", function () {
        document.body.classList.remove("menu-open");
      });

    // Toggle the hidden members div with dynamic height
    document
      .getElementById("members-btn")
      .addEventListener("click", function () {
        const membersDiv = document.getElementById("membersDiv");
        if (membersDiv.style.maxHeight) {
          membersDiv.style.maxHeight = null;
          membersDiv.classList.remove("open", "open-scroll"); // Close the div and remove scroll

        } else {
          // membersDiv.style.maxHeight = membersDiv.scrollHeight + "px";
          membersDiv.style.maxHeight = "275px";
          membersDiv.classList.add("open");

          // Wait for the transition to complete before enabling scrolling
          membersDiv.addEventListener(
            "transitionend",
            function () {
              membersDiv.classList.add("open-scroll");
            },
            { once: true }
          );
        }
        const membersCon = document.getElementById("membersCon");
        if (membersCon.style.maxHeight) {
          membersCon.style.maxHeight = null;
          membersCon.classList.remove("open"); // Close the div and remove scroll
        } else {
          // membersDiv.style.maxHeight = membersDiv.scrollHeight + "px";
          membersCon.style.maxHeight = "320px";
          membersCon.classList.add("open");
        }
      });


    // Generate random color for initials background
    function getRandomColor() {
      const letters = "0123456789ABCDEF";
      let color = "#";
      for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    // Generate initials from name
    function getInitials(name) {
      const nameParts = name.split(" ");
      const initials =
        nameParts[0].charAt(0).toUpperCase() +
        (nameParts[1] ? nameParts[1].charAt(0).toUpperCase() : "");
      return initials;
    }

    document.querySelector('.back-arrow').addEventListener('click', function () {
      // Add a class to hide the menu (e.g., sliding it out)
      document.querySelector('.profile-menu').classList.remove('profile-menu-open');
    });
    document.querySelector('#profile-button').addEventListener('click', function () {
      document.querySelector('.profile-menu').classList.add('profile-menu-open');
    });

    document.querySelector('#profileName').addEventListener('click', function () {
      const profileNameDiv = this;
      const currentName = profileNameDiv.innerText;

      // Create an input field for editing
      const inputField = document.createElement('input');
      inputField.type = 'text';
      inputField.value = currentName;
      inputField.classList.add('profile-name-input'); // Add a class for styling if needed

      // Replace the div with the input field
      profileNameDiv.replaceWith(inputField);
      inputField.focus();

      // Handle when the user finishes editing (e.g., pressing Enter or clicking outside)
      function saveName() {
        const updatedName = inputField.value;

        // Create a new div with the updated name
        const newProfileNameDiv = document.createElement('div');
        newProfileNameDiv.innerText = updatedName;
        newProfileNameDiv.classList.add('profile-name');
        newProfileNameDiv.id = 'profileName';

        // Replace the input field with the new div
        inputField.replaceWith(newProfileNameDiv);

        // Re-apply the event listener for future editing
        newProfileNameDiv.addEventListener('click', arguments.callee);
      }

      // Save on Enter key press
      inputField.addEventListener('keydown', function (event) {
        if (event.key === 'Enter') {
          saveName();
        }
      });

      // Save on losing focus (clicking outside)
      inputField.addEventListener('blur', saveName);
    });

    // Toggle dropdown visibility
    function toggleDropdown() {
      const dropdown = document.getElementById('customDropdown');
      dropdown.classList.toggle('open'); // Toggle the 'open' class

      // Highlight the currently selected item
      highlightSelectedItem();
    }

    // Highlight the currently selected item in the dropdown
    function highlightSelectedItem() {
      const selectedName = document.getElementById('selectedName').textContent;
      const dropdownItems = document.querySelectorAll('.dropdown-item');

      dropdownItems.forEach(item => {
        const itemName = item.querySelector('span').textContent;
        if (itemName === selectedName) {
          item.classList.add('selected-item');
        } else {
          item.classList.remove('selected-item');
        }
      });
    }

    // Select an item from the dropdown
    function selectItem(element) {
      const selectedName = element.querySelector("span").textContent;
      const selectedValue = element.getAttribute("data-value");

      // Update the button text with the selected name
      document.getElementById('dropdownButton').textContent = selectedName;

      // Update the displayed selected information
      document.getElementById("selectedName").textContent = selectedName;
      document.getElementById("selectedValue").textContent = selectedValue;

      // Close the dropdown after selection
      toggleDropdown();
    }

    // Edit item function
    function editItem(itemName) {
      event.stopPropagation(); // Prevent dropdown from closing when editing
      const newName = prompt("Edit the item name:", itemName);
      if (newName) {
        const dropdownItems = document.querySelectorAll(".dropdown-item span");
        dropdownItems.forEach(item => {
          if (item.textContent === itemName) {
            item.textContent = newName;
          }
        });
        alert(`${itemName} changed to ${newName}`);
      }
    }

    // Delete item function
    function deleteItem(itemName) {
      event.stopPropagation(); // Prevent dropdown from closing when deleting
      if (confirm(`Are you sure you want to delete ${itemName}?`)) {
        const dropdownItems = document.querySelectorAll(".dropdown-item");
        dropdownItems.forEach(item => {
          if (item.querySelector("span").textContent === itemName) {
            item.remove();
          }
        });
        alert(`${itemName} deleted`);
      }
    }

    // Add new item to the dropdown
    // Add new item to the dropdown
    function addNewItem() {
      const newItemName = document.getElementById("newItemName").value;
      const newItemUUID = generateUUID();  // Generate a new UUID for the item
      if (newItemName.trim() !== "") {
        const dropdown = document.getElementById("dropdownItems");
        const footer = document.querySelector('.dropdown-footer'); // Get the footer

        // Create a new dropdown item dynamically
        const newItem = document.createElement("div");
        newItem.classList.add("dropdown-item");
        newItem.setAttribute("data-value", newItemUUID);  // Assign UUID as data-value
        newItem.setAttribute("onclick", "selectItem(this)");  // Add click handler

        const newItemText = document.createElement("span");
        newItemText.textContent = newItemName;

        const editButton = document.createElement("button");
        editButton.textContent = "Edit";
        editButton.onclick = function (event) {
          event.stopPropagation();
          editItem(newItemName);
        };

        const deleteButton = document.createElement("button");
        deleteButton.textContent = "Delete";
        deleteButton.onclick = function (event) {
          event.stopPropagation();
          deleteItem(newItemName);
        };

        newItem.appendChild(newItemText);
        newItem.appendChild(editButton);
        newItem.appendChild(deleteButton);

        // Insert the new item before the footer
        dropdown.insertBefore(newItem, footer);

        // Clear input field after adding the item
        document.getElementById("newItemName").value = "";
      } else {
        alert("Please enter a valid item name.");
      }
    }
    // Function to generate a new UUID (for simplicity)
    function generateUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    // Function to handle the "Create" button click
    function createItem() {
      alert('Create button clicked');
    }

    // Function to handle the "Join" button click
    function joinItem() {
      alert('Join button clicked');
    }
  </script> -->
</body>

</html>